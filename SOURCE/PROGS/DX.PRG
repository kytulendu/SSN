 SELECT los.dg1, los.desc, COUNT(los.an), AVG(los.exp_6) FROM LOS GROUP BY los.dg1 ORDER BY los.dg1 INTO DBF temp_DX.DBF
 CREATE DBF DX_NO (dg1 C (5), desc C (84), cnt N (10, 0), avg_exp_6 N (16, 0))
 no = 1
 SELECT temp_dx
 INDEX ON cnt TAG cnt OF temp_dx DESCENDING
 SET ORDER TO cnt
 GOTO TOP
 DO WHILE .T.
    IF no=16
       EXIT
    ENDIF
    SELECT temp_dx
    SCATTER MEMVAR
    INSERT INTO dx_no FROM MEMVAR
    no = no+1
    SKIP
 ENDDO
 SELECT * FROM DX_NO INTO CURSOR DX_NO_A
 CREATE REPORT DX_NO.FRX FROM DX_NO_A COLUMN NOOVERWRITE WIDTH 150
 REPORT FORMAT DX_NO.FRX PDSETUP NOEJECT TO PRINTER NOCONSOLE
 CLOSE DATABASES
 DELETE FILE temp_dx.dbf
 DELETE FILE temp_dx.cdx
 DELETE FILE dx_no.dbf
*
